<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · MicroscopePSFs.jl</title><meta name="title" content="API Reference · MicroscopePSFs.jl"/><meta property="og:title" content="API Reference · MicroscopePSFs.jl"/><meta property="twitter:title" content="API Reference · MicroscopePSFs.jl"/><meta name="description" content="Documentation for MicroscopePSFs.jl."/><meta property="og:description" content="Documentation for MicroscopePSFs.jl."/><meta property="twitter:description" content="Documentation for MicroscopePSFs.jl."/><meta property="og:url" content="https://JuliaSMLM.github.io/MicroscopePSFs.jl/api/"/><meta property="twitter:url" content="https://JuliaSMLM.github.io/MicroscopePSFs.jl/api/"/><link rel="canonical" href="https://JuliaSMLM.github.io/MicroscopePSFs.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MicroscopePSFs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../interface/">Interface</a></li><li><a class="tocitem" href="../conventions/">Conventions</a></li><li><span class="tocitem">PSF Types</span><ul><li><a class="tocitem" href="../psfs/overview/">Overview</a></li><li><a class="tocitem" href="../psfs/gaussian2d/">Gaussian2D</a></li><li><a class="tocitem" href="../psfs/airy2d/">Airy2D</a></li><li><a class="tocitem" href="../psfs/scalar3d/">Scalar3D</a></li><li><a class="tocitem" href="../psfs/vector3d/">Vector3D</a></li><li><a class="tocitem" href="../psfs/spline_psf/">Spline PSF</a></li></ul></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Public-API"><span>Public API</span></a></li><li><a class="tocitem" href="#Complete-API-(All-Documented-Functions)"><span>Complete API (All Documented Functions)</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/main/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><p>This page provides a comprehensive reference of the types and functions in MicroscopePSFs.jl.</p><h2 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h2><p>These types and functions form the core public API of MicroscopePSFs.jl.</p><h3 id="PSF-Types"><a class="docs-heading-anchor" href="#PSF-Types">PSF Types</a><a id="PSF-Types-1"></a><a class="docs-heading-anchor-permalink" href="#PSF-Types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.AbstractPSF" href="#MicroscopePSFs.AbstractPSF"><code>MicroscopePSFs.AbstractPSF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractPSF</code></pre><p>Abstract base type for all Point Spread Functions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/types.jl#L3-L7">source</a></section></article><h4 id="2D-PSF-Models"><a class="docs-heading-anchor" href="#2D-PSF-Models">2D PSF Models</a><a id="2D-PSF-Models-1"></a><a class="docs-heading-anchor-permalink" href="#2D-PSF-Models" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Gaussian2D" href="#MicroscopePSFs.Gaussian2D"><code>MicroscopePSFs.Gaussian2D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Gaussian2D{T&lt;:AbstractFloat} &lt;: Abstract2DPSF{T}</code></pre><p>Isotropic 2D Gaussian PSF.</p><p><strong>Fields</strong></p><ul><li><code>σ</code>: Standard deviation in physical units (typically microns)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/types.jl#L19-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Airy2D" href="#MicroscopePSFs.Airy2D"><code>MicroscopePSFs.Airy2D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Airy2D{T&lt;:AbstractFloat} &lt;: Abstract2DPSF{T}</code></pre><p>2D Airy pattern PSF using paraxial, scalar model.</p><p>Field amplitude for a circular aperture is given by:     A(r) = ν/√(4π) * (2J₁(νr)/(νr)) where:     ν = 2π*nₐ/λ     J₁ is the Bessel function of first kind, order 1     r is the radial distance from optical axis</p><p><strong>Fields</strong></p><ul><li><code>nₐ</code>: Numerical aperture</li><li><code>λ</code>: Wavelength in microns</li><li><code>ν</code>: Optical parameter = 2π*nₐ/λ</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/types.jl#L31-L47">source</a></section></article><h4 id="3D-PSF-Models"><a class="docs-heading-anchor" href="#3D-PSF-Models">3D PSF Models</a><a id="3D-PSF-Models-1"></a><a class="docs-heading-anchor-permalink" href="#3D-PSF-Models" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Scalar3DPSF" href="#MicroscopePSFs.Scalar3DPSF"><code>MicroscopePSFs.Scalar3DPSF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Scalar3DPSF{T} &lt;: Abstract3DPSF{T}</code></pre><p>Scalar 3D PSF using explicit pupil function representation.</p><p><strong>Fields</strong></p><ul><li><code>nₐ::T</code>: Numerical aperture</li><li><code>λ::T</code>: Wavelength in microns</li><li><code>n::T</code>: Refractive index</li><li><code>pupil::PupilFunction{T}</code>: Complex pupil function</li><li><code>zernike_coeffs::Union{Nothing, ZernikeCoefficients{T}}</code>: Zernike coefficients used to create this PSF (if applicable)</li></ul><p><strong>Notes</strong></p><p>Can be initialized with either a PupilFunction or ZernikeCoefficients using the Scalar3DPSF factory function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/types.jl#L70-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Vector3DPSF" href="#MicroscopePSFs.Vector3DPSF"><code>MicroscopePSFs.Vector3DPSF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vector3DPSF{T&lt;:AbstractFloat} &lt;: Abstract3DPSF{T}</code></pre><p>Vector PSF model using explicit pupil function representation. Allows direct manipulation of pupil function for custom aberrations.</p><p><strong>Fields</strong></p><ul><li><code>nₐ::T</code>: Numerical aperture</li><li><code>λ::T</code>: Wavelength in microns</li><li><code>n_medium::T</code>: Sample medium refractive index</li><li><code>n_coverslip::T</code>: Cover slip refractive index</li><li><code>n_immersion::T</code>: Immersion medium refractive index</li><li><code>dipole::DipoleVector{T}</code>: Dipole orientation</li><li><code>z_stage::T</code>: Distance the sample stage was moved away from the nominal focal plane at the coverslip (μm)</li><li><code>vector_pupils::VectorPupilFunction{T}</code>: Pre-calculated pupil functions containing vector field components (Ex,Ey), dipole orientation effects, base aberrations, apodization, and all position-independent factors</li><li><code>base_pupil::Union{Nothing, PupilFunction{T}}</code>: Base pupil function representing system aberrations</li><li><code>zernike_coeffs::Union{Nothing, ZernikeCoefficients{T}}</code>: Zernike coefficients used to create this PSF (if applicable)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/types.jl#L102-L120">source</a></section></article><h4 id="Data-driven-PSF"><a class="docs-heading-anchor" href="#Data-driven-PSF">Data-driven PSF</a><a id="Data-driven-PSF-1"></a><a class="docs-heading-anchor-permalink" href="#Data-driven-PSF" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.SplinePSF" href="#MicroscopePSFs.SplinePSF"><code>MicroscopePSFs.SplinePSF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SplinePSF{T&lt;:AbstractFloat, IT&lt;:AbstractInterpolation} &lt;: AbstractPSF</code></pre><p>A point spread function (PSF) represented as a B-spline interpolation.</p><p><strong>Fields</strong></p><ul><li><code>spline</code>: The B-spline interpolation object </li><li><code>x_range</code>: Range of x-coordinates used for uniform grid interpolation</li><li><code>y_range</code>: Range of y-coordinates used for uniform grid interpolation  </li><li><code>z_range</code>: Range of z-coordinates for 3D PSFs, or <code>nothing</code> for 2D PSFs</li><li><code>original_grid</code>: Original grid data used to create the interpolation</li><li><code>interp_order</code>: Interpolation order used (0=constant, 1=linear, 3=cubic)</li></ul><p><strong>Notes</strong></p><ul><li>Coordinates and ranges are in physical units (typically microns)</li><li>PSF values are preserved from the original PSF that was sampled</li><li>Interpolation order determines the smoothness of the interpolation:<ul><li>0: Constant (nearest neighbor)</li><li>1: Linear</li><li>3: Cubic B-spline (default, most accurate)</li></ul></li><li>The original grid is stored to ensure exact reproduction when saving/loading</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/spline_psf.jl#L3-L24">source</a></section></article><h3 id="Core-Interface-Functions"><a class="docs-heading-anchor" href="#Core-Interface-Functions">Core Interface Functions</a><a id="Core-Interface-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Interface-Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.amplitude" href="#MicroscopePSFs.amplitude"><code>MicroscopePSFs.amplitude</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">amplitude(p::PupilFunction, x::Real, y::Real, z::Real)</code></pre><p>Calculate complex amplitude from pupil function integration.</p><p><strong>Arguments</strong></p><ul><li><code>p::PupilFunction</code>: Pupil function</li><li><code>x::Real</code>: X position in μm</li><li><code>y::Real</code>: Y position in μm</li><li><code>z::Real</code>: Z position in μm</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/pupil.jl#L208-L217">source</a></section><section><div><pre><code class="language-julia hljs">amplitude(psf::AbstractPSF, x::Real, y::Real)</code></pre><p>Evaluate complex field amplitude at position (x,y) relative to PSF center.</p><p><strong>Arguments</strong></p><ul><li><code>x, y</code>: Position in microns relative to PSF center</li></ul><p><strong>Returns</strong></p><ul><li>Complex amplitude normalized such that |amplitude|² gives normalized intensity</li></ul><p><strong>Coordinates</strong></p><p>Input coordinates (x,y) are in physical units (microns) relative to PSF center.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">psf = Airy2D(1.4, 0.532)
amp = amplitude(psf, 0.1, 0.2)
intensity = abs2(amp)  # Convert to intensity</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/interfaces.jl#L36-L56">source</a></section><section><div><pre><code class="language-julia hljs">amplitude(psf::AbstractPSF, x::Real, y::Real, z::Real)</code></pre><p>Evaluate complex field amplitude in 3D. z is axial distance from focus in microns.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/interfaces.jl#L61-L65">source</a></section><section><div><pre><code class="language-julia hljs">amplitude(psf::Scalar3DPSF{T}, x::Real, y::Real, z::Real) where {T}</code></pre><p>Calculate complex amplitude at a 3D position using scalar diffraction theory.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: Scalar3DPSF instance</li><li><code>x, y, z</code>: Position in microns relative to PSF center</li></ul><p><strong>Returns</strong></p><ul><li>Complex amplitude at the specified position</li></ul><p><strong>Notes</strong></p><ul><li>Uses Fourier optics to propagate from pupil to image space</li><li>Accounts for defocus and aberrations encoded in the pupil function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/scalar3d.jl#L66-L81">source</a></section><section><div><pre><code class="language-julia hljs">amplitude(psf::Vector3DPSF, x::Real, y::Real, z::Real)</code></pre><p>Compute complex vector amplitude at given position.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: Vector PSF instance</li><li><code>x, y</code>: Lateral position in microns relative to PSF center</li><li><code>z</code>: Axial position in microns representing depth above the coverslip</li></ul><p><strong>Returns</strong></p><ul><li>Vector [Ex, Ey] of complex field amplitudes</li></ul><p><strong>Notes</strong></p><ul><li>z coordinate represents the depth above the coverslip</li><li>z_stage in the PSF indicates the distance the stage was moved away from the nominal focal plane</li><li>Includes both UAF and SAF contributions automatically</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/vector3d.jl#L69-L86">source</a></section><section><div><pre><code class="language-julia hljs">amplitude(psf::SplinePSF, x::Real, y::Real, z::Real)</code></pre><p>Calculate the complex amplitude of the 3D PSF at position (x, y, z).</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: SplinePSF instance</li><li><code>x, y, z</code>: Coordinates in microns relative to PSF center</li></ul><p><strong>Returns</strong></p><ul><li>Complex amplitude = sqrt(intensity) with zero phase</li></ul><p><strong>Notes</strong></p><ul><li>Returns sqrt(intensity) as Complex to match the interface of other PSFs</li><li>The SplinePSF does not model phase information</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/spline_psf.jl#L415-L430">source</a></section><section><div><pre><code class="language-julia hljs">amplitude(psf::SplinePSF, x::Real, y::Real)</code></pre><p>Calculate the complex amplitude of the PSF at position (x, y) with z=0.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: SplinePSF instance</li><li><code>x, y</code>: Coordinates in microns relative to PSF center</li></ul><p><strong>Returns</strong></p><ul><li>Complex amplitude = sqrt(intensity) with zero phase</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/spline_psf.jl#L436-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.integrate_pixels" href="#MicroscopePSFs.integrate_pixels"><code>MicroscopePSFs.integrate_pixels</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_pixels(psf::AbstractPSF, camera::AbstractCamera, emitter::AbstractEmitter; sampling::Integer=2)</code></pre><p>Integrate PSF intensity over camera pixels.</p><p>For each pixel in the camera, numerically integrates the PSF intensity using the specified  sampling density. Physical coordinates are relative to camera with (0,0) at top-left corner.</p><p><strong>Arguments</strong></p><ul><li><code>psf::AbstractPSF</code>: Point spread function to integrate</li><li><code>camera::AbstractCamera</code>: Camera geometry defining pixel edges in microns</li><li><code>emitter::AbstractEmitter</code>: Emitter with position in microns relative to camera</li><li><code>sampling::Integer=2</code>: Number of samples per pixel in each dimension</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{T}</code>: Integrated intensities where T matches emitter.photons type</li><li>Array is indexed as [y,x] with [1,1] at top-left pixel</li><li>Values represent actual photon counts in each pixel based on emitter&#39;s photon value</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">camera = IdealCamera(0:0.1:2.0, 0:0.1:2.0)  # 20x20 camera, 100nm pixels
emitter = Emitter2D(1.0, 1.0, 1000.0)       # Emitter at (1μm, 1μm) with 1000 photons
psf = Gaussian2D(0.15)                       # σ = 150nm
pixels = integrate_pixels(psf, camera, emitter)
# Sum of pixels will be ≤ 1000, depending on how much of the PSF is captured by the camera</code></pre><p>See also: <a href="#MicroscopePSFs.integrate_pixels_amplitude"><code>integrate_pixels_amplitude</code></a>, <a href="#MicroscopePSFs.AbstractPSF"><code>AbstractPSF</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/integration.jl#L75-L104">source</a></section><section><div><pre><code class="language-julia hljs">integrate_pixels(psf::Scalar3DPSF,
                camera::AbstractCamera,
                emitter::AbstractEmitter;
                sampling::Integer=2)</code></pre><p>Integrate PSF intensity over camera pixels for a 3D emitter.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: Scalar3DPSF instance</li><li><code>camera</code>: Camera geometry defining pixel layout</li><li><code>emitter</code>: Emitter with position information (must have z-coordinate)</li><li><code>sampling</code>: Subpixel sampling density for integration accuracy (default: 2)</li></ul><p><strong>Returns</strong></p><ul><li>Array of integrated PSF intensities with dimensions [ny, nx]</li><li>Values represent actual photon counts based on emitter.photons</li></ul><p><strong>Notes</strong></p><ul><li>Uses the z-coordinate from the emitter for the focal plane</li><li>Higher sampling values give more accurate results but slower computation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/scalar3d.jl#L106-L127">source</a></section><section><div><pre><code class="language-julia hljs">integrate_pixels(psf::Vector3DPSF,
                camera::AbstractCamera,
                emitter::AbstractEmitter;
                sampling::Integer=2)</code></pre><p>Integrate Vector3DPSF over camera pixels.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: Vector3DPSF instance with fixed dipole orientation</li><li><code>camera</code>: Camera geometry</li><li><code>emitter</code>: Emitter with position information (emitter.z represents depth above the coverslip)</li><li><code>sampling</code>: Subpixel sampling density for integration accuracy</li></ul><p><strong>Returns</strong></p><ul><li>Array of integrated PSF intensities with dimensions [ny, nx]</li><li>Values represent actual photon counts based on emitter.photons</li></ul><p><strong>Notes</strong></p><ul><li>Dipole orientation comes from the PSF itself, not the emitter</li><li>For varying dipole orientations, create multiple PSFs</li><li>The emitter&#39;s z position must represent depth above the coverslip</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/vector3d.jl#L191-L213">source</a></section><section><div><pre><code class="language-julia hljs">integrate_pixels(psf::SplinePSF, 
                camera::AbstractCamera, 
                emitter::AbstractEmitter;
                sampling::Integer=2)</code></pre><p>Integrate PSF over camera pixels using interpolation.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: SplinePSF instance</li><li><code>camera</code>: Camera geometry</li><li><code>emitter</code>: Emitter with position information</li><li><code>sampling</code>: Subpixel sampling density for integration accuracy</li></ul><p><strong>Returns</strong></p><ul><li>Array of integrated PSF intensities with dimensions [ny, nx]</li><li>Values represent actual photon counts based on emitter&#39;s photon value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/spline_psf.jl#L455-L472">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.integrate_pixels_amplitude" href="#MicroscopePSFs.integrate_pixels_amplitude"><code>MicroscopePSFs.integrate_pixels_amplitude</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_pixels_amplitude(psf::AbstractPSF, camera::AbstractCamera, emitter::AbstractEmitter; sampling::Integer=2)</code></pre><p>Integrate PSF complex amplitude over camera pixels.</p><p>For each pixel in the camera, numerically integrates the PSF amplitude using the specified sampling density. Unlike intensity integration, returns unnormalized complex amplitudes which can be used for coherent calculations.</p><p><strong>Arguments</strong></p><ul><li><code>psf::AbstractPSF</code>: Point spread function to integrate</li><li><code>camera::AbstractCamera</code>: Camera geometry defining pixel edges in microns</li><li><code>emitter::AbstractEmitter</code>: Emitter with position in microns relative to camera</li><li><code>sampling::Integer=2</code>: Number of samples per pixel in each dimension</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Complex{T}}</code>: Integrated complex amplitudes where T matches emitter.photons type</li><li>Array is indexed as [y,x] with [1,1] at top-left pixel</li><li>Values are not normalized to preserve complex amplitude relationships</li></ul><p><strong>Notes</strong></p><ul><li>For coherent calculations, use this function instead of <code>integrate_pixels</code></li><li>Return type is complex to support PSFs with phase information</li><li>To get intensity from amplitude: <code>abs2.(integrate_pixels_amplitude(...))</code></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">camera = IdealCamera(0:0.1:2.0, 0:0.1:2.0)  # 20x20 camera, 100nm pixels
emitter = Emitter2D(1.0, 1.0, 1000.0)       # Emitter at (1μm, 1μm)
psf = Gaussian2D(0.15)                       # σ = 150nm
amplitudes = integrate_pixels_amplitude(psf, camera, emitter)
intensities = abs2.(amplitudes)              # Convert to intensity if needed</code></pre><p>See also: <a href="#MicroscopePSFs.integrate_pixels"><code>integrate_pixels</code></a>, <a href="#MicroscopePSFs.AbstractPSF"><code>AbstractPSF</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/integration.jl#L119-L154">source</a></section><section><div><pre><code class="language-julia hljs">integrate_pixels_amplitude(psf::Vector3DPSF,
                          camera::AbstractCamera,
                          emitter::AbstractEmitter;
                          sampling::Integer=2)</code></pre><p>Integrate Vector3DPSF complex amplitude over camera pixels.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: Vector3DPSF instance with fixed dipole orientation</li><li><code>camera</code>: Camera geometry</li><li><code>emitter</code>: Emitter with position information (emitter.z represents depth above the coverslip)</li><li><code>sampling</code>: Subpixel sampling density for integration accuracy</li></ul><p><strong>Returns</strong></p><ul><li>Array of integrated complex field components with dimensions [ny, nx, 2]</li><li>First two dimensions are spatial, third dimension holds [Ex, Ey]</li></ul><p><strong>Notes</strong></p><ul><li>For coherent calculations in vectorial microscopy</li><li>Preserves relative phase information between field components</li><li>The emitter&#39;s z position must represent depth above the coverslip</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/vector3d.jl#L236-L258">source</a></section><section><div><pre><code class="language-julia hljs">integrate_pixels_amplitude(psf::SplinePSF,
                         camera::AbstractCamera,
                         emitter::AbstractEmitter;
                         sampling::Integer=2)</code></pre><p>Integrate PSF amplitude (complex) over camera pixels.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: SplinePSF instance</li><li><code>camera</code>: Camera geometry</li><li><code>emitter</code>: Emitter with position information</li><li><code>sampling</code>: Subpixel sampling density for integration accuracy</li></ul><p><strong>Returns</strong></p><ul><li>Array of integrated PSF complex amplitudes with dimensions [ny, nx]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/spline_psf.jl#L503-L519">source</a></section></article><h3 id="Pupil-Functions"><a class="docs-heading-anchor" href="#Pupil-Functions">Pupil Functions</a><a id="Pupil-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Pupil-Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.PupilFunction" href="#MicroscopePSFs.PupilFunction"><code>MicroscopePSFs.PupilFunction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PupilFunction{T}</code></pre><p>Represents a pupil function with physical parameters.</p><p><strong>Fields</strong></p><ul><li><code>nₐ</code>: Numerical aperture</li><li><code>λ</code>: Wavelength in μm</li><li><code>n</code>: Refractive index</li><li><code>field</code>: Complex-valued pupil function array</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/pupil.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.VectorPupilFunction" href="#MicroscopePSFs.VectorPupilFunction"><code>MicroscopePSFs.VectorPupilFunction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">VectorPupilFunction{T}</code></pre><p>Vector pupil function storing Ex,Ey field components as PupilFunctions.</p><p><strong>Fields</strong></p><ul><li><code>nₐ::T</code>: Numerical aperture</li><li><code>λ::T</code>: Wavelength in μm</li><li><code>n_medium::T</code>: Refractive index of the sample medium</li><li><code>n_coverslip::T</code>: Refractive index of the coverslip</li><li><code>n_immersion::T</code>: Refractive index of the immersion medium</li><li><code>Ex::PupilFunction{T}</code>: x-component of electric field</li><li><code>Ey::PupilFunction{T}</code>: y-component of electric field</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_pupil.jl#L3-L16">source</a></section></article><h3 id="Zernike-Module"><a class="docs-heading-anchor" href="#Zernike-Module">Zernike Module</a><a id="Zernike-Module-1"></a><a class="docs-heading-anchor-permalink" href="#Zernike-Module" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.ZernikeCoefficients" href="#MicroscopePSFs.Zernike.ZernikeCoefficients"><code>MicroscopePSFs.Zernike.ZernikeCoefficients</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ZernikeCoefficients{T&lt;:Real}</code></pre><p>Mutable structure to hold Zernike coefficients for both magnitude and phase of a pupil function.</p><p><strong>Fields</strong></p><ul><li><code>mag::Vector{T}</code>: Coefficients for magnitude</li><li><code>phase::Vector{T}</code>: Coefficients for phase</li></ul><p><strong>Notes</strong></p><ul><li>First coefficient (index 1) typically represents piston</li><li>Magnitude coefficients are typically normalized with mag[1] = 1</li><li>Phase coefficients represent phase in radians</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/types.jl#L15-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.ZernikeIndexing" href="#MicroscopePSFs.Zernike.ZernikeIndexing"><code>MicroscopePSFs.Zernike.ZernikeIndexing</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ZernikeIndexing</code></pre><p>Enum type for different Zernike polynomial indexing conventions. Used to specify which indexing scheme to use in calculations.</p><p><strong>Values</strong></p><ul><li><code>OSA</code>: OSA/ANSI standard indexing</li><li><code>Noll</code>: Noll indexing scheme</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/types.jl#L3-L12">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>OSA</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Noll</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Aberration-Functions"><a class="docs-heading-anchor" href="#Aberration-Functions">Aberration Functions</a><a id="Aberration-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Aberration-Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_aberration!" href="#MicroscopePSFs.Zernike.add_aberration!"><code>MicroscopePSFs.Zernike.add_aberration!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_aberration!(coeffs::ZernikeCoefficients, 
               index::Integer, 
               mag_value::Real=0, 
               phase_value::Real=0;
               indexing::ZernikeIndexing=OSA) -&gt; ZernikeCoefficients</code></pre><p>Add aberration terms to existing coefficients.</p><p><strong>Arguments</strong></p><ul><li><code>coeffs</code>: ZernikeCoefficients to modify</li><li><code>index</code>: Index of Zernike term (starting at 0)</li><li><code>mag_value</code>: Value to add to magnitude coefficient</li><li><code>phase_value</code>: Value to add to phase coefficient</li><li><code>indexing</code>: Indexing convention for the index</li></ul><p><strong>Notes</strong></p><ul><li>Index is 0-based to match standard Zernike notation</li><li>Returns the modified coefficients for chaining</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L20-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_defocus!" href="#MicroscopePSFs.Zernike.add_defocus!"><code>MicroscopePSFs.Zernike.add_defocus!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_defocus!(coeffs::ZernikeCoefficients, amount::Real) -&gt; ZernikeCoefficients</code></pre><p>Add defocus aberration (n=2, l=0).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_astigmatism!" href="#MicroscopePSFs.Zernike.add_astigmatism!"><code>MicroscopePSFs.Zernike.add_astigmatism!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_astigmatism!(coeffs::ZernikeCoefficients, 
                 amount::Real, 
                 angle::Real=0.0) -&gt; ZernikeCoefficients</code></pre><p>Add astigmatism with specified magnitude and angle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L67-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_coma!" href="#MicroscopePSFs.Zernike.add_coma!"><code>MicroscopePSFs.Zernike.add_coma!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_coma!(coeffs::ZernikeCoefficients, 
          amount::Real, 
          angle::Real=0.0) -&gt; ZernikeCoefficients</code></pre><p>Add coma with specified magnitude and angle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L82-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_spherical!" href="#MicroscopePSFs.Zernike.add_spherical!"><code>MicroscopePSFs.Zernike.add_spherical!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_spherical!(coeffs::ZernikeCoefficients, amount::Real) -&gt; ZernikeCoefficients</code></pre><p>Add primary spherical aberration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.reset!" href="#MicroscopePSFs.Zernike.reset!"><code>MicroscopePSFs.Zernike.reset!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reset!(coeffs::ZernikeCoefficients) -&gt; ZernikeCoefficients</code></pre><p>Reset coefficients to default state (mag[1]=1, all others zero).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.scale!" href="#MicroscopePSFs.Zernike.scale!"><code>MicroscopePSFs.Zernike.scale!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale!(coeffs::ZernikeCoefficients, factor::Real) -&gt; ZernikeCoefficients</code></pre><p>Scale all coefficients (except piston) by given factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L107-L111">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>merge!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.rms" href="#MicroscopePSFs.Zernike.rms"><code>MicroscopePSFs.Zernike.rms</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rms(coeffs::ZernikeCoefficients) -&gt; Tuple{Float64,Float64}</code></pre><p>Calculate RMS values for magnitude and phase coefficients (excluding piston).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L138-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.trim!" href="#MicroscopePSFs.Zernike.trim!"><code>MicroscopePSFs.Zernike.trim!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trim!(coeffs::ZernikeCoefficients, threshold::Real) -&gt; ZernikeCoefficients</code></pre><p>Set coefficients below threshold (relative to RMS) to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L149-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.significant_terms" href="#MicroscopePSFs.Zernike.significant_terms"><code>MicroscopePSFs.Zernike.significant_terms</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">significant_terms(coeffs::ZernikeCoefficients, 
                 threshold::Real=0.01) -&gt; Vector{Tuple{Int,Float64,Float64}}</code></pre><p>Return list of significant terms: (index, magnitude, phase) above threshold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L169-L174">source</a></section></article><h3 id="Zernike-Polynomial-Functions"><a class="docs-heading-anchor" href="#Zernike-Polynomial-Functions">Zernike Polynomial Functions</a><a id="Zernike-Polynomial-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Zernike-Polynomial-Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.zernikepolynomial" href="#MicroscopePSFs.Zernike.zernikepolynomial"><code>MicroscopePSFs.Zernike.zernikepolynomial</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zernikepolynomial(n::Integer, l::Integer, ρ::Real, ϕ::Real) -&gt; Real</code></pre><p>Compute the complete Zernike polynomial Z_n^l(ρ,ϕ).</p><p><strong>Arguments</strong></p><ul><li><code>n</code>: Radial order</li><li><code>l</code>: Azimuthal frequency (signed)</li><li><code>ρ</code>: Radial coordinate (0 ≤ ρ ≤ 1)</li><li><code>ϕ</code>: Azimuthal angle in radians</li></ul><p><strong>Notes</strong></p><ul><li>Uses born-wolf normalization</li><li>Combines radial polynomial with appropriate trigonometric function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/polynomials.jl#L47-L61">source</a></section><section><div><pre><code class="language-julia hljs">zernikepolynomial(j::Integer, ρ::Real, ϕ::Real, indexing::ZernikeIndexing=OSA) -&gt; Real</code></pre><p>Compute Zernike polynomial using single-index notation.</p><p><strong>Arguments</strong></p><ul><li><code>j</code>: Polynomial index (OSA or Noll)</li><li><code>ρ</code>: Radial coordinate</li><li><code>ϕ</code>: Azimuthal angle</li><li><code>indexing</code>: Index convention to use (OSA or Noll)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/polynomials.jl#L72-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.radialpolynomial" href="#MicroscopePSFs.Zernike.radialpolynomial"><code>MicroscopePSFs.Zernike.radialpolynomial</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">radialpolynomial(n::Integer, m::Integer, ρ::Real) -&gt; Real</code></pre><p>Compute the radial component R_n^m(ρ) of the Zernike polynomial.</p><p><strong>Arguments</strong></p><ul><li><code>n</code>: Radial order</li><li><code>m</code>: Azimuthal order (absolute value of azimuthal frequency)</li><li><code>ρ</code>: Radial coordinate (0 ≤ ρ ≤ 1)</li></ul><p><strong>Notes</strong></p><ul><li>Returns 0 for ρ &gt; 1</li><li>Normalizes according to born-wolf convention</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/polynomials.jl#L8-L21">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>max_radial_order</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.evaluate_pupil" href="#MicroscopePSFs.Zernike.evaluate_pupil"><code>MicroscopePSFs.Zernike.evaluate_pupil</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluate_pupil(coeffs::ZernikeCoefficients, grid_size::Integer;
              indexing::ZernikeIndexing=OSA) -&gt; Matrix{Complex{Float64}}</code></pre><p>Generate complex pupil function from Zernike coefficients.</p><p><strong>Arguments</strong></p><ul><li><code>coeffs</code>: ZernikeCoefficients containing magnitude and phase coefficients</li><li><code>grid_size</code>: Size of the output grid (grid<em>size × grid</em>size)</li><li><code>indexing</code>: Indexing convention for coefficients (OSA or Noll)</li></ul><p><strong>Returns</strong></p><ul><li>Complex-valued matrix representing the pupil function</li></ul><p><strong>Notes</strong></p><ul><li>Output grid is normalized to unit circle</li><li>Points outside unit circle are set to zero</li><li>Phase is applied as exp(iϕ)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/polynomials.jl#L88-L106">source</a></section></article><h3 id="Index-Conversion"><a class="docs-heading-anchor" href="#Index-Conversion">Index Conversion</a><a id="Index-Conversion-1"></a><a class="docs-heading-anchor-permalink" href="#Index-Conversion" title="Permalink"></a></h3><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>nl2osa</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>osa2nl</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>nl2noll</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>noll2nl</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>osa2noll</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>noll2osa</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>convert_index</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Emitters"><a class="docs-heading-anchor" href="#Emitters">Emitters</a><a id="Emitters-1"></a><a class="docs-heading-anchor-permalink" href="#Emitters" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.DipoleVector" href="#MicroscopePSFs.DipoleVector"><code>MicroscopePSFs.DipoleVector</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DipoleVector{T} &lt;: Real</code></pre><p>A 3D vector representing the dipole orientation.</p><p><strong>Fields</strong></p><ul><li><code>px::T</code>: x component of the dipole vector</li><li><code>py::T</code>: y component of the dipole vector</li><li><code>pz::T</code>: z component of the dipole vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/emitters.jl#L5-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.DipoleEmitter3D" href="#MicroscopePSFs.DipoleEmitter3D"><code>MicroscopePSFs.DipoleEmitter3D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DipoleEmitter3D{T} &lt;: AbstractEmitter</code></pre><p>3D dipole emitter with position, orientation and optical properties.</p><p><strong>Fields</strong></p><ul><li><code>x::T</code>: x-coordinate in microns</li><li><code>y::T</code>: y-coordinate in microns </li><li><code>z::T</code>: z-coordinate in microns</li><li><code>photons::T</code>: number of photons</li><li><code>dipole::DipoleVector{T}</code>: dipole orientation vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/emitters.jl#L33-L44">source</a></section></article><h3 id="I/O-Functions"><a class="docs-heading-anchor" href="#I/O-Functions">I/O Functions</a><a id="I/O-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#I/O-Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.save_psf" href="#MicroscopePSFs.save_psf"><code>MicroscopePSFs.save_psf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_psf(filename::String, object; metadata::Dict=Dict())</code></pre><p>Save a PSF or related object (e.g., ZernikeCoefficients, PupilFunction) to an HDF5 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: Path where the PSF will be saved</li><li><code>object</code>: Object to save (PSF, ZernikeCoefficients, PupilFunction, etc.)</li><li><code>metadata</code>: Optional dictionary of additional metadata to include</li></ul><p><strong>Returns</strong></p><ul><li><code>filename</code> for chaining</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/io.jl#L22-L34">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>load_psf</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Complete-API-(All-Documented-Functions)"><a class="docs-heading-anchor" href="#Complete-API-(All-Documented-Functions)">Complete API (All Documented Functions)</a><a id="Complete-API-(All-Documented-Functions)-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-API-(All-Documented-Functions)" title="Permalink"></a></h2><p>This section lists additional internal functions and types that are documented but not part of the public API.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Abstract2DPSF" href="#MicroscopePSFs.Abstract2DPSF"><code>MicroscopePSFs.Abstract2DPSF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Abstract2DPSF{T&lt;:AbstractFloat}</code></pre><p>Abstract type for all 2D point spread functions. Parameterized by numeric type T.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/types.jl#L11-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Abstract3DPSF" href="#MicroscopePSFs.Abstract3DPSF"><code>MicroscopePSFs.Abstract3DPSF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Abstract3DPSF{T&lt;:AbstractFloat}</code></pre><p>Abstract type for all 3D point spread functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/types.jl#L63-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._check_normalization-Tuple{Any}" href="#MicroscopePSFs._check_normalization-Tuple{Any}"><code>MicroscopePSFs._check_normalization</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_check_normalization(values; tol=1e-6)</code></pre><p>Internal function to verify array sums to 1 within tolerance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/utils.jl#L55-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._integrate_pixels_generic-Union{Tuple{T}, Tuple{AbstractPSF, AbstractCamera, AbstractEmitter, Function, Type{T}}} where T" href="#MicroscopePSFs._integrate_pixels_generic-Union{Tuple{T}, Tuple{AbstractPSF, AbstractCamera, AbstractEmitter, Function, Type{T}}} where T"><code>MicroscopePSFs._integrate_pixels_generic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_integrate_pixels_generic(
    psf::AbstractPSF,
    camera::AbstractCamera,
    emitter::AbstractEmitter,
    f::Function,  # Function to integrate
    ::Type{T};   # Return type
    sampling::Integer=2
) where T</code></pre><p>Internal generic integration routine used by both intensity and amplitude integration.</p><p><strong>Returns</strong></p><ul><li>Matrix{T} with dimensions [y,x] starting at [1,1] for top-left pixel</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/integration.jl#L3-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._io_check_required_fields-Tuple{Any, Any}" href="#MicroscopePSFs._io_check_required_fields-Tuple{Any, Any}"><code>MicroscopePSFs._io_check_required_fields</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_io_check_required_fields(group, fields)</code></pre><p>Check if all required fields exist in an HDF5 group. Throws an error if any required field is missing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/common.jl#L100-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._io_load_complex_array-Tuple{Any, Any}" href="#MicroscopePSFs._io_load_complex_array-Tuple{Any, Any}"><code>MicroscopePSFs._io_load_complex_array</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_io_load_complex_array(group, name)</code></pre><p>Load a complex array from an HDF5 group by combining real and imaginary parts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/common.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._io_load_range-Tuple{Any, Any}" href="#MicroscopePSFs._io_load_range-Tuple{Any, Any}"><code>MicroscopePSFs._io_load_range</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_io_load_range(group, name)</code></pre><p>Load a range from an HDF5 group by reconstructing from start, step, and length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/common.jl#L44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._io_load_zernike_coeffs-Tuple{Any}" href="#MicroscopePSFs._io_load_zernike_coeffs-Tuple{Any}"><code>MicroscopePSFs._io_load_zernike_coeffs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_io_load_zernike_coeffs(file; group_name=&quot;zernike_coefficients&quot;)</code></pre><p>Load ZernikeCoefficients from an HDF5 file from a specified group. Returns nothing if the group doesn&#39;t exist.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/common.jl#L72-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._io_save_complex_array-Tuple{Any, Any, Any}" href="#MicroscopePSFs._io_save_complex_array-Tuple{Any, Any, Any}"><code>MicroscopePSFs._io_save_complex_array</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_io_save_complex_array(group, name, array)</code></pre><p>Save a complex array to an HDF5 group by splitting into real and imaginary parts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/common.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._io_save_pupil_params-Tuple{Any, Any}" href="#MicroscopePSFs._io_save_pupil_params-Tuple{Any, Any}"><code>MicroscopePSFs._io_save_pupil_params</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_io_save_pupil_params(params, pupil)</code></pre><p>Save common pupil parameters to an HDF5 group.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/common.jl#L89-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._io_save_range-Tuple{Any, Any, Any}" href="#MicroscopePSFs._io_save_range-Tuple{Any, Any, Any}"><code>MicroscopePSFs._io_save_range</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_io_save_range(group, name, range)</code></pre><p>Save a range to an HDF5 group by storing start, step, and length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/common.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._io_save_zernike_coeffs-Tuple{Any, Any}" href="#MicroscopePSFs._io_save_zernike_coeffs-Tuple{Any, Any}"><code>MicroscopePSFs._io_save_zernike_coeffs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_io_save_zernike_coeffs(file, coeffs; group_name=&quot;zernike_coefficients&quot;)</code></pre><p>Save ZernikeCoefficients to an HDF5 file in a specified group. Does nothing if coeffs is nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/common.jl#L58-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{Airy2D}}" href="#MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{Airy2D}}"><code>MicroscopePSFs._load_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_psf_impl(file::HDF5.File, ::Type{Airy2D})</code></pre><p>Load an Airy2D PSF from an HDF5 file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/basic_psfs.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{Gaussian2D}}" href="#MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{Gaussian2D}}"><code>MicroscopePSFs._load_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_psf_impl(file::HDF5.File, ::Type{Gaussian2D})</code></pre><p>Load a Gaussian2D PSF from an HDF5 file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/basic_psfs.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{PupilFunction}}" href="#MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{PupilFunction}}"><code>MicroscopePSFs._load_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_psf_impl(file::HDF5.File, ::Type{PupilFunction})</code></pre><p>Load a PupilFunction from an HDF5 file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/pupil.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{Scalar3DPSF}}" href="#MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{Scalar3DPSF}}"><code>MicroscopePSFs._load_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_psf_impl(file::HDF5.File, ::Type{Scalar3DPSF})</code></pre><p>Load a Scalar3DPSF from an HDF5 file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/scalar3d.jl#L30-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{SplinePSF}}" href="#MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{SplinePSF}}"><code>MicroscopePSFs._load_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_psf_impl(file::HDF5.File, ::Type{SplinePSF})</code></pre><p>Load a SplinePSF from an HDF5 file, reconstructing it using the standard constructor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/spline.jl#L40-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{Vector3DPSF}}" href="#MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{Vector3DPSF}}"><code>MicroscopePSFs._load_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_psf_impl(file::HDF5.File, ::Type{Vector3DPSF})</code></pre><p>Load a Vector3DPSF from an HDF5 file, reconstructing all components.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/vector3d.jl#L55-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{VectorPupilFunction}}" href="#MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{VectorPupilFunction}}"><code>MicroscopePSFs._load_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_psf_impl(file::HDF5.File, ::Type{VectorPupilFunction})</code></pre><p>Load a VectorPupilFunction from an HDF5 file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/pupil.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{ZernikeCoefficients}}" href="#MicroscopePSFs._load_psf_impl-Tuple{HDF5.File, Type{ZernikeCoefficients}}"><code>MicroscopePSFs._load_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_psf_impl(file::HDF5.File, ::Type{ZernikeCoefficients})</code></pre><p>Load ZernikeCoefficients from an HDF5 file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/zernike.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._sample_psf_2d-Tuple{AbstractPSF, AbstractRange, AbstractRange}" href="#MicroscopePSFs._sample_psf_2d-Tuple{AbstractPSF, AbstractRange, AbstractRange}"><code>MicroscopePSFs._sample_psf_2d</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_sample_psf_2d(psf::AbstractPSF, x_range::AbstractRange, y_range::AbstractRange)</code></pre><p>Internal helper function to sample a 2D PSF on a regular grid. Returns an array with dimensions [y, x] containing raw PSF values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/spline_psf.jl#L57-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._sample_psf_3d-Tuple{AbstractPSF, AbstractRange, AbstractRange, AbstractRange}" href="#MicroscopePSFs._sample_psf_3d-Tuple{AbstractPSF, AbstractRange, AbstractRange, AbstractRange}"><code>MicroscopePSFs._sample_psf_3d</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_sample_psf_3d(psf::AbstractPSF, x_range::AbstractRange, y_range::AbstractRange, z_range::AbstractRange)</code></pre><p>Internal helper function to sample a 3D PSF on a regular grid. Returns an array with dimensions [y, x, z] containing raw PSF values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/spline_psf.jl#L36-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, Airy2D}" href="#MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, Airy2D}"><code>MicroscopePSFs._save_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_save_psf_impl(file::HDF5.File, psf::Airy2D)</code></pre><p>Save an Airy2D PSF to an HDF5 file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/basic_psfs.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, Gaussian2D}" href="#MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, Gaussian2D}"><code>MicroscopePSFs._save_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_save_psf_impl(file::HDF5.File, psf::Gaussian2D)</code></pre><p>Save a Gaussian2D PSF to an HDF5 file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/basic_psfs.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, PupilFunction}" href="#MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, PupilFunction}"><code>MicroscopePSFs._save_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_save_psf_impl(file::HDF5.File, pupil::PupilFunction)</code></pre><p>Save a PupilFunction to an HDF5 file, including physical parameters and complex field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/pupil.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, Scalar3DPSF}" href="#MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, Scalar3DPSF}"><code>MicroscopePSFs._save_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_save_psf_impl(file::HDF5.File, psf::Scalar3DPSF)</code></pre><p>Save a Scalar3DPSF to an HDF5 file, including pupil function and any Zernike coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/scalar3d.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, SplinePSF}" href="#MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, SplinePSF}"><code>MicroscopePSFs._save_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_save_psf_impl(file::HDF5.File, psf::SplinePSF)</code></pre><p>Save a SplinePSF to an HDF5 file, including the original grid data used to create the spline interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/spline.jl#L9-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, Vector3DPSF}" href="#MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, Vector3DPSF}"><code>MicroscopePSFs._save_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_save_psf_impl(file::HDF5.File, psf::Vector3DPSF)</code></pre><p>Save a Vector3DPSF to an HDF5 file, including all optical parameters, dipole orientation, and vector pupil fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/vector3d.jl#L9-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, VectorPupilFunction}" href="#MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, VectorPupilFunction}"><code>MicroscopePSFs._save_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_save_psf_impl(file::HDF5.File, pupil::VectorPupilFunction)</code></pre><p>Save a VectorPupilFunction to an HDF5 file, including all physical parameters and both Ex and Ey field components.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/pupil.jl#L56-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, ZernikeCoefficients}" href="#MicroscopePSFs._save_psf_impl-Tuple{HDF5.File, ZernikeCoefficients}"><code>MicroscopePSFs._save_psf_impl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_save_psf_impl(file::HDF5.File, zc::ZernikeCoefficients)</code></pre><p>Save ZernikeCoefficients to an HDF5 file, storing magnitude and phase arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/io/zernike.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.apply_aperture!" href="#MicroscopePSFs.apply_aperture!"><code>MicroscopePSFs.apply_aperture!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_aperture!(p::PupilFunction, radius::Real=1.0)</code></pre><p>Apply circular aperture to pupil function. Radius is relative to NA.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/pupil.jl#L190-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.apply_defocus!-Tuple{PupilFunction, Real}" href="#MicroscopePSFs.apply_defocus!-Tuple{PupilFunction, Real}"><code>MicroscopePSFs.apply_defocus!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_defocus!(p::PupilFunction, z::Real)</code></pre><p>Apply defocus phase to pupil function for propagation distance z.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/pupil.jl#L167-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.calculate_apodization-NTuple{4, Real}" href="#MicroscopePSFs.calculate_apodization-NTuple{4, Real}"><code>MicroscopePSFs.calculate_apodization</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_apodization(kr2::Real, λ::Real, 
                    n_medium::Real, n_immersion::Real)</code></pre><p>Calculate apodization factor for energy conservation.</p><p><strong>Arguments</strong></p><ul><li><code>kr2</code>: Squared lateral spatial frequency</li><li><code>λ</code>: Wavelength in microns</li><li><code>n_medium</code>: Refractive index of the sample medium</li><li><code>n_immersion</code>: Refractive index of the immersion medium</li></ul><p><strong>Returns</strong></p><ul><li>Apodization factor for energy conservation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_tools.jl#L152-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.calculate_axial_phase" href="#MicroscopePSFs.calculate_axial_phase"><code>MicroscopePSFs.calculate_axial_phase</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_axial_phase(z::Real, z_stage::Real, kz_medium::Complex, 
                     kz_coverslip::Complex, kz_immersion::Complex,
                     coverslip_thickness::Real=0.17)</code></pre><p>Calculate total axial phase from defocus.</p><p><strong>Arguments</strong></p><ul><li><code>z</code>: Emitter position relative to the coverslip (depth above the coverslip in μm)</li><li><code>z_stage</code>: Distance the sample stage was moved away from the nominal focal plane at the coverslip (μm)</li><li><code>kz_medium</code>: z-component of wave vector in sample medium</li><li><code>kz_coverslip</code>: z-component of wave vector in coverslip</li><li><code>kz_immersion</code>: z-component of wave vector in immersion medium</li><li><code>coverslip_thickness</code>: Thickness of coverslip in mm (default: 0.17mm)</li></ul><p><strong>Returns</strong></p><ul><li>Defocus phase</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_tools.jl#L93-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.calculate_dipole_field_components-Tuple{Complex, Complex, Complex, DipoleVector, Complex, Complex}" href="#MicroscopePSFs.calculate_dipole_field_components-Tuple{Complex, Complex, Complex, DipoleVector, Complex, Complex}"><code>MicroscopePSFs.calculate_dipole_field_components</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_dipole_field_components(ϕ::Complex, sinθ::Complex, cosθ::Complex,
                                dipole::DipoleVector, Tp::Complex, Ts::Complex)</code></pre><p>Calculate vectorial field components for a dipole orientation.</p><p><strong>Arguments</strong></p><ul><li><code>ϕ</code>: Azimuthal angle in pupil plane</li><li><code>sinθ</code>: Sine of polar angle</li><li><code>cosθ</code>: Cosine of polar angle</li><li><code>dipole</code>: Dipole orientation vector</li><li><code>Tp</code>: p-polarization transmission coefficient</li><li><code>Ts</code>: s-polarization transmission coefficient</li></ul><p><strong>Returns</strong></p><ul><li>Tuple (Ex, Ey) of complex field components</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_tools.jl#L120-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.calculate_interface_fresnel-NTuple{4, Real}" href="#MicroscopePSFs.calculate_interface_fresnel-NTuple{4, Real}"><code>MicroscopePSFs.calculate_interface_fresnel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_interface_fresnel(kr2::Real, λ::Real, 
                          n1::Real, n2::Real)</code></pre><p>Calculate Fresnel transmission coefficients for a single interface.</p><p><strong>Arguments</strong></p><ul><li><code>kr2</code>: Squared lateral spatial frequency</li><li><code>λ</code>: Wavelength in microns</li><li><code>n1</code>: Refractive index of first medium</li><li><code>n2</code>: Refractive index of second medium</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (Tp, Ts): p and s polarization transmission coefficients</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_tools.jl#L37-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.calculate_wave_vectors-NTuple{5, Real}" href="#MicroscopePSFs.calculate_wave_vectors-NTuple{5, Real}"><code>MicroscopePSFs.calculate_wave_vectors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_wave_vectors(kr2::Real, λ::Real, 
                     n_medium::Real, n_coverslip::Real, n_immersion::Real)</code></pre><p>Calculate z-components of wave vectors in all three media.</p><p><strong>Arguments</strong></p><ul><li><code>kr2</code>: Squared lateral spatial frequency</li><li><code>λ</code>: Wavelength in microns</li><li><code>n_medium</code>: Refractive index of the sample medium</li><li><code>n_coverslip</code>: Refractive index of the coverslip</li><li><code>n_immersion</code>: Refractive index of the immersion medium</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (kz<em>medium, kz</em>coverslip, kz_immersion): z-components of wave vectors in each medium</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_tools.jl#L8-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.fill_vector_pupils!" href="#MicroscopePSFs.fill_vector_pupils!"><code>MicroscopePSFs.fill_vector_pupils!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill_vector_pupils!(vpupil::VectorPupilFunction, dipole::DipoleVector,
                  base_pupil::Union{Nothing, PupilFunction}=nothing)</code></pre><p>Fill vector pupil function with field components including dipole orientation, base aberrations, and proper apodization.</p><p>This pre-calculates all position-independent factors of the pupil function.</p><p><strong>Arguments</strong></p><ul><li><code>vpupil</code>: Vector pupil function to fill</li><li><code>dipole</code>: Dipole orientation vector</li><li><code>base_pupil</code>: Optional base aberration pupil function</li></ul><p><strong>Returns</strong></p><ul><li>Filled and normalized vector pupil function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_pupil.jl#L100-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.kmax-Tuple{PupilFunction}" href="#MicroscopePSFs.kmax-Tuple{PupilFunction}"><code>MicroscopePSFs.kmax</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmax(p::PupilFunction)</code></pre><p>Get maximum spatial frequency in μm⁻¹</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/pupil.jl#L30-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.kmax-Tuple{VectorPupilFunction}" href="#MicroscopePSFs.kmax-Tuple{VectorPupilFunction}"><code>MicroscopePSFs.kmax</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get maximum spatial frequency in μm⁻¹</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_pupil.jl#L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.kpixelsize-Tuple{PupilFunction}" href="#MicroscopePSFs.kpixelsize-Tuple{PupilFunction}"><code>MicroscopePSFs.kpixelsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kpixelsize(p::PupilFunction)</code></pre><p>Get pupil plane sampling in μm⁻¹</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/pupil.jl#L42-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.kpixelsize-Tuple{VectorPupilFunction}" href="#MicroscopePSFs.kpixelsize-Tuple{VectorPupilFunction}"><code>MicroscopePSFs.kpixelsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get pupil plane sampling in μm⁻¹</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_pupil.jl#L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.k₀-Tuple{PupilFunction}" href="#MicroscopePSFs.k₀-Tuple{PupilFunction}"><code>MicroscopePSFs.k₀</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k₀(p::PupilFunction)</code></pre><p>Get central wavevector magnitude in μm⁻¹</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/pupil.jl#L36-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.k₀-Tuple{VectorPupilFunction}" href="#MicroscopePSFs.k₀-Tuple{VectorPupilFunction}"><code>MicroscopePSFs.k₀</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get central wavevector magnitude in μm⁻¹</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_pupil.jl#L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.normalize!-Tuple{PupilFunction}" href="#MicroscopePSFs.normalize!-Tuple{PupilFunction}"><code>MicroscopePSFs.normalize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize!(p::PupilFunction)</code></pre><p>Normalize pupil function to unit energy using Parseval&#39;s theorem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/pupil.jl#L148-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.normalize!-Tuple{VectorPupilFunction}" href="#MicroscopePSFs.normalize!-Tuple{VectorPupilFunction}"><code>MicroscopePSFs.normalize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize!(p::VectorPupilFunction)</code></pre><p>Normalize the electric field components of the vector pupil function. Ensures total energy across both components equals 1.</p><p><strong>Arguments</strong></p><ul><li><code>p</code>: Vector pupil function to normalize</li></ul><p><strong>Returns</strong></p><ul><li>Normalized vector pupil function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/pupils/vector_pupil.jl#L78-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.update_pupils!-Tuple{Vector3DPSF}" href="#MicroscopePSFs.update_pupils!-Tuple{Vector3DPSF}"><code>MicroscopePSFs.update_pupils!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_pupils!(psf::Vector3DPSF) -&gt; Vector3DPSF</code></pre><p>Update the vector pupil function based on stored Zernike coefficients and/or base pupil. This is useful after modifying aberrations to regenerate the pupil fields.</p><p><strong>Arguments</strong></p><ul><li><code>psf</code>: Vector3DPSF to update</li></ul><p><strong>Returns</strong></p><ul><li>Updated Vector3DPSF</li></ul><p><strong>Notes</strong></p><ul><li>Requires either stored Zernike coefficients or a base pupil</li><li>Returns the updated PSF for method chaining</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/psfs/vector3d.jl#L149-L164">source</a></section></article><h3 id="Zernike-Module-Internal-API"><a class="docs-heading-anchor" href="#Zernike-Module-Internal-API">Zernike Module Internal API</a><a id="Zernike-Module-Internal-API-1"></a><a class="docs-heading-anchor-permalink" href="#Zernike-Module-Internal-API" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_astigmatism!" href="#MicroscopePSFs.Zernike.add_astigmatism!"><code>MicroscopePSFs.Zernike.add_astigmatism!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_astigmatism!(coeffs::ZernikeCoefficients, 
                 amount::Real, 
                 angle::Real=0.0) -&gt; ZernikeCoefficients</code></pre><p>Add astigmatism with specified magnitude and angle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L67-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_coma!" href="#MicroscopePSFs.Zernike.add_coma!"><code>MicroscopePSFs.Zernike.add_coma!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_coma!(coeffs::ZernikeCoefficients, 
          amount::Real, 
          angle::Real=0.0) -&gt; ZernikeCoefficients</code></pre><p>Add coma with specified magnitude and angle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L82-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_defocus!-Tuple{ZernikeCoefficients, Real}" href="#MicroscopePSFs.Zernike.add_defocus!-Tuple{ZernikeCoefficients, Real}"><code>MicroscopePSFs.Zernike.add_defocus!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_defocus!(coeffs::ZernikeCoefficients, amount::Real) -&gt; ZernikeCoefficients</code></pre><p>Add defocus aberration (n=2, l=0).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.add_spherical!-Tuple{ZernikeCoefficients, Real}" href="#MicroscopePSFs.Zernike.add_spherical!-Tuple{ZernikeCoefficients, Real}"><code>MicroscopePSFs.Zernike.add_spherical!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_spherical!(coeffs::ZernikeCoefficients, amount::Real) -&gt; ZernikeCoefficients</code></pre><p>Add primary spherical aberration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.build_zernike_basis-Tuple{Integer, Integer}" href="#MicroscopePSFs.Zernike.build_zernike_basis-Tuple{Integer, Integer}"><code>MicroscopePSFs.Zernike.build_zernike_basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_zernike_basis(grid_size::Integer, num_terms::Integer;
                   indexing::ZernikeIndexing=OSA) -&gt; Matrix{Float64}</code></pre><p>Build a matrix of Zernike polynomials for least-squares fitting.</p><p><strong>Arguments</strong></p><ul><li><code>grid_size</code>: Size of the sampling grid</li><li><code>num_terms</code>: Number of Zernike terms to include</li><li><code>indexing</code>: Indexing convention for polynomials</li></ul><p><strong>Returns</strong></p><ul><li>Matrix of size (valid<em>points, num</em>terms) containing Zernike values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/fitting.jl#L8-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.evaluate_polynomial_grid-Tuple{Integer, Integer, Integer}" href="#MicroscopePSFs.Zernike.evaluate_polynomial_grid-Tuple{Integer, Integer, Integer}"><code>MicroscopePSFs.Zernike.evaluate_polynomial_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluate_polynomial_grid(n::Integer, l::Integer, grid_size::Integer) -&gt; Matrix{Float64}</code></pre><p>Generate a grid of Zernike polynomial values for visualization.</p><p><strong>Arguments</strong></p><ul><li><code>n</code>: Radial order</li><li><code>l</code>: Azimuthal frequency</li><li><code>grid_size</code>: Size of output grid</li></ul><p><strong>Returns</strong></p><ul><li>Matrix of polynomial values over [-1,1] × [-1,1]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/polynomials.jl#L137-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.fit_error-Tuple{AbstractMatrix{&lt;:Complex}, ZernikeCoefficients}" href="#MicroscopePSFs.Zernike.fit_error-Tuple{AbstractMatrix{&lt;:Complex}, ZernikeCoefficients}"><code>MicroscopePSFs.Zernike.fit_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_error(pupil::AbstractMatrix{&lt;:Complex}, coeffs::ZernikeCoefficients;
         indexing::ZernikeIndexing=OSA) -&gt; Float64</code></pre><p>Calculate RMS error between pupil and its Zernike fit.</p><p><strong>Returns</strong></p><ul><li>RMS error normalized to mean pupil magnitude</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/fitting.jl#L135-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.get_nl" href="#MicroscopePSFs.Zernike.get_nl"><code>MicroscopePSFs.Zernike.get_nl</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_nl(j::Integer, indexing::ZernikeIndexing=OSA) -&gt; Tuple{Int,Int}</code></pre><p>Get (n,l) indices from either OSA or Noll index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/indexing.jl#L173-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.merge!" href="#MicroscopePSFs.Zernike.merge!"><code>MicroscopePSFs.Zernike.merge!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge!(target::ZernikeCoefficients, 
       source::ZernikeCoefficients, 
       weight::Real=1.0) -&gt; ZernikeCoefficients</code></pre><p>Merge source coefficients into target with optional weighting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L120-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.propagate_field-Union{Tuple{T}, Tuple{ZernikeCoefficients{T}, Vararg{T, 6}}} where T&lt;:Real" href="#MicroscopePSFs.Zernike.propagate_field-Union{Tuple{T}, Tuple{ZernikeCoefficients{T}, Vararg{T, 6}}} where T&lt;:Real"><code>MicroscopePSFs.Zernike.propagate_field</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">propagate_field(coeffs::ZernikeCoefficients{T},
               λ::T, n::T, nₐ::T,
               r::T, φ::T, z::T;
               nk::Integer=100) where {T&lt;:Real}</code></pre><p>Propagate field from pupil described by Zernike coefficients to point (r,φ,z).</p><p>U(r,φ,z) = 2π ∫₀^k<em>max dk</em>r k<em>r e^{2πiz√(k²-k</em>r²)} ∑<em>{n,m} R</em>n^m J<em>m(2πk</em>r r)[C<em>a cos(mφ) + C</em>b sin(mφ)]</p><p>C<em>a is the complex coefficient for the Zernike mode (n,m) and C</em>b is the complex coefficient for (n,-m).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/debye.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.rms-Tuple{ZernikeCoefficients}" href="#MicroscopePSFs.Zernike.rms-Tuple{ZernikeCoefficients}"><code>MicroscopePSFs.Zernike.rms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rms(coeffs::ZernikeCoefficients) -&gt; Tuple{Float64,Float64}</code></pre><p>Calculate RMS values for magnitude and phase coefficients (excluding piston).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L138-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.scale!-Tuple{ZernikeCoefficients, Real}" href="#MicroscopePSFs.Zernike.scale!-Tuple{ZernikeCoefficients, Real}"><code>MicroscopePSFs.Zernike.scale!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale!(coeffs::ZernikeCoefficients, factor::Real) -&gt; ZernikeCoefficients</code></pre><p>Scale all coefficients (except piston) by given factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.significant_terms" href="#MicroscopePSFs.Zernike.significant_terms"><code>MicroscopePSFs.Zernike.significant_terms</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">significant_terms(coeffs::ZernikeCoefficients, 
                 threshold::Real=0.01) -&gt; Vector{Tuple{Int,Float64,Float64}}</code></pre><p>Return list of significant terms: (index, magnitude, phase) above threshold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L169-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.trim!-Tuple{ZernikeCoefficients, Real}" href="#MicroscopePSFs.Zernike.trim!-Tuple{ZernikeCoefficients, Real}"><code>MicroscopePSFs.Zernike.trim!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trim!(coeffs::ZernikeCoefficients, threshold::Real) -&gt; ZernikeCoefficients</code></pre><p>Set coefficients below threshold (relative to RMS) to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/utils.jl#L149-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MicroscopePSFs.Zernike.unwrap_phase-Tuple{AbstractVector{&lt;:Real}}" href="#MicroscopePSFs.Zernike.unwrap_phase-Tuple{AbstractVector{&lt;:Real}}"><code>MicroscopePSFs.Zernike.unwrap_phase</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unwrap_phase(phase::AbstractVector{&lt;:Real}) -&gt; Vector{Float64}</code></pre><p>Unwrap phase values to handle 2π discontinuities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/382c620cb73a94a9fcf0be4bee07d85ed2f5fdbb/src/zernike/fitting.jl#L117-L121">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../psfs/spline_psf/">« Spline PSF</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 14 March 2025 20:50">Friday 14 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
