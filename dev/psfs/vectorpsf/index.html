<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>VectorPSF · MicroscopePSFs.jl</title><meta name="title" content="VectorPSF · MicroscopePSFs.jl"/><meta property="og:title" content="VectorPSF · MicroscopePSFs.jl"/><meta property="twitter:title" content="VectorPSF · MicroscopePSFs.jl"/><meta name="description" content="Documentation for MicroscopePSFs.jl."/><meta property="og:description" content="Documentation for MicroscopePSFs.jl."/><meta property="twitter:description" content="Documentation for MicroscopePSFs.jl."/><meta property="og:url" content="https://JuliaSMLM.github.io/MicroscopePSFs.jl/psfs/vectorpsf/"/><meta property="twitter:url" content="https://JuliaSMLM.github.io/MicroscopePSFs.jl/psfs/vectorpsf/"/><link rel="canonical" href="https://JuliaSMLM.github.io/MicroscopePSFs.jl/psfs/vectorpsf/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MicroscopePSFs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../interface/">Interface</a></li><li><a class="tocitem" href="../../conventions/">Conventions</a></li><li><span class="tocitem">PSF Types</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../gaussianpsf/">GaussianPSF</a></li><li><a class="tocitem" href="../airypsf/">AiryPSF</a></li><li><a class="tocitem" href="../scalarpsf/">ScalarPSF</a></li><li class="is-active"><a class="tocitem" href>VectorPSF</a><ul class="internal"><li><a class="tocitem" href="#Mathematical-Model"><span>Mathematical Model</span></a></li><li><a class="tocitem" href="#Constructor-and-Parameters"><span>Constructor and Parameters</span></a></li><li><a class="tocitem" href="#Dipole-Orientation-Options"><span>Dipole Orientation Options</span></a></li><li><a class="tocitem" href="#Key-Features"><span>Key Features</span></a></li><li><a class="tocitem" href="#Refractive-Index-Interfaces"><span>Refractive Index Interfaces</span></a></li><li><a class="tocitem" href="#Supercritical-Angle-Fluorescence"><span>Supercritical Angle Fluorescence</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li><li><a class="tocitem" href="#Limitations"><span>Limitations</span></a></li></ul></li><li><a class="tocitem" href="../splinepsf/">SplinePSF</a></li></ul></li><li><a class="tocitem" href="../../zernike/">Zernike Polynomials</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PSF Types</a></li><li class="is-active"><a href>VectorPSF</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>VectorPSF</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/main/docs/src/psfs/vectorpsf.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="VectorPSF"><a class="docs-heading-anchor" href="#VectorPSF">VectorPSF</a><a id="VectorPSF-1"></a><a class="docs-heading-anchor-permalink" href="#VectorPSF" title="Permalink"></a></h1><p>The <code>VectorPSF</code> model implements a comprehensive three-dimensional point spread function based on vectorial diffraction theory. It accounts for polarization effects, high-NA phenomena, dipole emission patterns, refractive index interfaces, and arbitrary aberrations, providing the highest level of physical accuracy among the PSF models.</p><h2 id="Mathematical-Model"><a class="docs-heading-anchor" href="#Mathematical-Model">Mathematical Model</a><a id="Mathematical-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Model" title="Permalink"></a></h2><p>The VectorPSF implements the full Richards-Wolf vector diffraction theory, accounting for the vectorial nature of light. The key formula for the electric field at the image plane is:</p><p class="math-container">\[PSF(x - x_i, y - y_i, z_i, z_s) = \sum_{m=x,y} \sum_{n=p_x, p_y, p_z} |F[h(k_x, k_y)w_{m,n}A(k_x, k_y)e^{\iota 2\pi(k_x x_i+k_y y_i+k_{z\mathrm{med}} z_i-k_{z\mathrm{imm}}z_s)}]|^2\]</p><p>Where:</p><ul><li><span>$(x_i, y_i, z_i)$</span> is the emitter position where <span>$z_i$</span> represents the depth above the coverslip</li><li><span>$z_s$</span> is the distance the sample stage was moved from nominal focus</li><li><span>$F$</span> denotes the Fourier transform operation </li><li><span>$h(k_x, k_y)$</span> is the complex pupil function incorporating aberrations </li><li><span>$w_{m,n}$</span> represents electric field components at the pupil plane</li><li><span>$A(k_x, k_y)$</span> is the apodization factor for energy conservation </li><li><span>$k_{z\mathrm{med}}$</span> and <span>$k_{z\mathrm{imm}}$</span> are z-components of wave vectors in the sample and immersion media</li></ul><h2 id="Constructor-and-Parameters"><a class="docs-heading-anchor" href="#Constructor-and-Parameters">Constructor and Parameters</a><a id="Constructor-and-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Constructor-and-Parameters" title="Permalink"></a></h2><pre><code class="language-julia hljs">VectorPSF(nₐ::Real, λ::Real, dipole::DipoleVector;
         base_pupil::Union{Nothing, PupilFunction}=nothing,
         base_zernike::Union{Nothing, ZernikeCoefficients}=nothing,
         n_medium::Real=1.33,
         n_coverslip::Real=1.52,
         n_immersion::Real=1.52,
         z_stage::Real=0.0, 
         grid_size::Integer=128)</code></pre><h3 id="Required-Parameters"><a class="docs-heading-anchor" href="#Required-Parameters">Required Parameters</a><a id="Required-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Required-Parameters" title="Permalink"></a></h3><ul><li><code>nₐ</code>: Numerical aperture of the objective</li><li><code>λ</code>: Wavelength of light in microns</li><li><code>dipole</code>: Dipole orientation vector specified using <code>DipoleVector</code></li></ul><h3 id="Optional-Parameters"><a class="docs-heading-anchor" href="#Optional-Parameters">Optional Parameters</a><a id="Optional-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Optional-Parameters" title="Permalink"></a></h3><ul><li><code>base_pupil</code>: Optional base aberration pupil function (default: none)</li><li><code>base_zernike</code>: Zernike coefficients for aberrations (default: none)</li><li><code>n_medium</code>: Refractive index of the sample medium (default: 1.33, water)</li><li><code>n_immersion</code>: Refractive index of the immersion medium (default: 1.52, oil)</li><li><code>n_coverslip</code>: Refractive index of the coverslip (default: 1.52, glass)</li><li><code>z_stage</code>: Distance the sample stage was moved (μm) (default: 0.0)</li><li><code>grid_size</code>: Size of grid for pupil function (default: 128)</li></ul><h2 id="Dipole-Orientation-Options"><a class="docs-heading-anchor" href="#Dipole-Orientation-Options">Dipole Orientation Options</a><a id="Dipole-Orientation-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Dipole-Orientation-Options" title="Permalink"></a></h2><p>The VectorPSF supports both fixed and rotating dipole orientations:</p><h3 id="Fixed-Dipole"><a class="docs-heading-anchor" href="#Fixed-Dipole">Fixed Dipole</a><a id="Fixed-Dipole-1"></a><a class="docs-heading-anchor-permalink" href="#Fixed-Dipole" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create a VectorPSF with specific dipole orientation
dipole_xy = DipoleVector(0.707, 0.707, 0.0)  # 45° in XY plane
psf = VectorPSF(1.4, 0.532, dipole_xy, n_medium=1.33)</code></pre><h3 id="Rotating-Dipole-(Isotropic-Emission)"><a class="docs-heading-anchor" href="#Rotating-Dipole-(Isotropic-Emission)">Rotating Dipole (Isotropic Emission)</a><a id="Rotating-Dipole-(Isotropic-Emission)-1"></a><a class="docs-heading-anchor-permalink" href="#Rotating-Dipole-(Isotropic-Emission)" title="Permalink"></a></h3><pre><code class="language-julia hljs"># No dipole specification required - uses incoherent average of x, y, z dipoles
psf = VectorPSF(1.4, 0.532, n_medium=1.33)</code></pre><p>The rotating dipole model represents a freely rotating fluorophore by calculating the incoherent sum of three orthogonal dipole orientations.</p><h2 id="Key-Features"><a class="docs-heading-anchor" href="#Key-Features">Key Features</a><a id="Key-Features-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Features" title="Permalink"></a></h2><ul><li><strong>Polarization Effects</strong>: Models the vectorial nature of light propagation</li><li><strong>Dipole Emission Patterns</strong>: Accounts for the orientation of fluorescent dipoles</li><li><strong>High-NA Accuracy</strong>: Correctly handles the optical physics at high numerical apertures</li><li><strong>Refractive Index Interfaces</strong>: Models light propagation across media interfaces</li><li><strong>Supercritical Angle Fluorescence</strong>: Captures SAF effects for emitters near coverslip</li></ul><h2 id="Refractive-Index-Interfaces"><a class="docs-heading-anchor" href="#Refractive-Index-Interfaces">Refractive Index Interfaces</a><a id="Refractive-Index-Interfaces-1"></a><a class="docs-heading-anchor-permalink" href="#Refractive-Index-Interfaces" title="Permalink"></a></h2><p>The VectorPSF accounts for refractive index mismatches:</p><pre><code class="language-julia hljs"># Water sample with oil immersion objective
psf = VectorPSF(
    1.4, 0.532, dipole_z,
    n_medium=1.33,   # Water sample
    n_immersion=1.52  # Oil immersion
)</code></pre><h2 id="Supercritical-Angle-Fluorescence"><a class="docs-heading-anchor" href="#Supercritical-Angle-Fluorescence">Supercritical Angle Fluorescence</a><a id="Supercritical-Angle-Fluorescence-1"></a><a class="docs-heading-anchor-permalink" href="#Supercritical-Angle-Fluorescence" title="Permalink"></a></h2><p>A notable feature of the VectorPSF model is its ability to accurately capture Supercritical Angle Fluorescence (SAF), which occurs when light emitted by fluorophores near the coverslip is collected at angles exceeding the critical angle. SAF contribution decreases as the emitter moves away from the coverslip.</p><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Create a basic VectorPSF with Z-oriented dipole
dipole_z = DipoleVector(0.0, 0.0, 1.0)
psf = VectorPSF(
    1.4,                # Numerical aperture
    0.532,              # Wavelength in microns
    dipole_z,           # Z-oriented dipole
    n_medium=1.33,      # Sample is water
    n_immersion=1.52   # Immersion oil
)

# Create a PSF with aberrations
zc = ZernikeCoefficients(15)
zc[11] = 0.5  # Add spherical aberration (normalized to rms = 1.0)
psf_aberrated = VectorPSF(
    1.4, 0.532, dipole_z,
    n_medium=1.33,
    base_zernike=zc
)</code></pre><h2 id="Limitations"><a class="docs-heading-anchor" href="#Limitations">Limitations</a><a id="Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Limitations" title="Permalink"></a></h2><ol><li><strong>Computational Intensity</strong>: Most computationally demanding PSF model</li><li><strong>Parameter Complexity</strong>: Requires understanding of multiple physical parameters</li><li><strong>Speed</strong>: Significantly slower than other PSF models, especially with fine grid sizes</li></ol><p>For standard usage patterns, camera integration, and comparison with other PSF types, see the <a href="../overview/">PSF Overview</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scalarpsf/">« ScalarPSF</a><a class="docs-footer-nextpage" href="../splinepsf/">SplinePSF »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Friday 21 March 2025 20:31">Friday 21 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
