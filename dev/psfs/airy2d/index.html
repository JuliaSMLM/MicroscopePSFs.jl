<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Airy2D · MicroscopePSFs.jl</title><meta name="title" content="Airy2D · MicroscopePSFs.jl"/><meta property="og:title" content="Airy2D · MicroscopePSFs.jl"/><meta property="twitter:title" content="Airy2D · MicroscopePSFs.jl"/><meta name="description" content="Documentation for MicroscopePSFs.jl."/><meta property="og:description" content="Documentation for MicroscopePSFs.jl."/><meta property="twitter:description" content="Documentation for MicroscopePSFs.jl."/><meta property="og:url" content="https://JuliaSMLM.github.io/MicroscopePSFs.jl/psfs/airy2d/"/><meta property="twitter:url" content="https://JuliaSMLM.github.io/MicroscopePSFs.jl/psfs/airy2d/"/><link rel="canonical" href="https://JuliaSMLM.github.io/MicroscopePSFs.jl/psfs/airy2d/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MicroscopePSFs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../interface/">Interface</a></li><li><a class="tocitem" href="../../conventions/">Conventions</a></li><li><span class="tocitem">PSF Types</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../gaussian2d/">Gaussian2D</a></li><li class="is-active"><a class="tocitem" href>Airy2D</a><ul class="internal"><li><a class="tocitem" href="#Mathematical-Model"><span>Mathematical Model</span></a></li><li><a class="tocitem" href="#Constructor-Options"><span>Constructor Options</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#Integration-with-Camera"><span>Integration with Camera</span></a></li><li><a class="tocitem" href="#Properties-of-the-Airy-Pattern"><span>Properties of the Airy Pattern</span></a></li><li><a class="tocitem" href="#Performance-Considerations"><span>Performance Considerations</span></a></li><li><a class="tocitem" href="#Limitations"><span>Limitations</span></a></li><li><a class="tocitem" href="#Relationship-to-Other-PSFs"><span>Relationship to Other PSFs</span></a></li></ul></li><li><a class="tocitem" href="../scalar3d/">Scalar3D</a></li><li><a class="tocitem" href="../vector3d/">Vector3D</a></li><li><a class="tocitem" href="../spline_psf/">Spline PSF</a></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PSF Types</a></li><li class="is-active"><a href>Airy2D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Airy2D</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSMLM/MicroscopePSFs.jl/blob/main/docs/src/psfs/airy2d.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Airy2D"><a class="docs-heading-anchor" href="#Airy2D">Airy2D</a><a id="Airy2D-1"></a><a class="docs-heading-anchor-permalink" href="#Airy2D" title="Permalink"></a></h1><p>The <code>Airy2D</code> PSF model represents the diffraction-limited point spread function for a circular aperture under the paraxial approximation. Unlike the simpler Gaussian approximation, this model accurately captures the characteristic diffraction rings that appear in real microscope images, making it more physically accurate while still maintaining good computational efficiency.</p><h2 id="Mathematical-Model"><a class="docs-heading-anchor" href="#Mathematical-Model">Mathematical Model</a><a id="Mathematical-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Model" title="Permalink"></a></h2><p>The Airy pattern is defined in terms of its field amplitude:</p><p class="math-container">\[A(r) = \frac{\nu}{\sqrt{4\pi}} \cdot \frac{2J_1(\nu r)}{\nu r}\]</p><p>where:</p><ul><li><span>$r = \sqrt{x^2 + y^2}$</span> is the radial distance from the optical axis in microns</li><li><span>$\nu = \frac{2\pi \cdot \text{NA}}{\lambda}$</span> is the optical parameter</li><li><span>$J_1$</span> is the Bessel function of the first kind, order 1</li><li><span>$\text{NA}$</span> is the numerical aperture</li><li><span>$\lambda$</span> is the wavelength in microns</li></ul><p>The intensity is given by the squared magnitude of the amplitude:</p><p class="math-container">\[I(r) = |A(r)|^2\]</p><h2 id="Constructor-Options"><a class="docs-heading-anchor" href="#Constructor-Options">Constructor Options</a><a id="Constructor-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Constructor-Options" title="Permalink"></a></h2><pre><code class="language-julia hljs">Airy2D(na::Real, wavelength::Real)</code></pre><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><ul><li><code>na</code>: Numerical aperture of the objective</li><li><code>wavelength</code>: Wavelength of light in microns</li></ul><h3 id="Alternative-Constructor"><a class="docs-heading-anchor" href="#Alternative-Constructor">Alternative Constructor</a><a id="Alternative-Constructor-1"></a><a class="docs-heading-anchor-permalink" href="#Alternative-Constructor" title="Permalink"></a></h3><pre><code class="language-julia hljs">Airy2D(psf::Gaussian2D; λ::Real=0.532)</code></pre><p>Creates an <code>Airy2D</code> PSF that approximates the provided <code>Gaussian2D</code> PSF, using the specified wavelength.</p><h3 id="Type-Parameters"><a class="docs-heading-anchor" href="#Type-Parameters">Type Parameters</a><a id="Type-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Type-Parameters" title="Permalink"></a></h3><ul><li><code>T</code>: Numeric precision type, automatically determined from input</li></ul><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><h3 id="Creating-a-PSF"><a class="docs-heading-anchor" href="#Creating-a-PSF">Creating a PSF</a><a id="Creating-a-PSF-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-PSF" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create an Airy PSF for a high-NA objective with green light
psf = Airy2D(1.4, 0.532)  # NA=1.4, wavelength=532nm

# Create from a Gaussian2D PSF (for comparison purposes)
gaussian_psf = Gaussian2D(0.15)
airy_equivalent = Airy2D(gaussian_psf, λ=0.532)</code></pre><h3 id="Direct-Evaluation"><a class="docs-heading-anchor" href="#Direct-Evaluation">Direct Evaluation</a><a id="Direct-Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-Evaluation" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Evaluate PSF at a specific position
intensity = psf(0.1, 0.2)  # At position x=0.1μm, y=0.2μm

# Get complex amplitude
amp = amplitude(psf, 0.1, 0.2)</code></pre><h3 id="Creating-a-PSF-Image"><a class="docs-heading-anchor" href="#Creating-a-PSF-Image">Creating a PSF Image</a><a id="Creating-a-PSF-Image-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-PSF-Image" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create a grid of positions
x = range(-2, 2, length=201)  # μm
y = range(-2, 2, length=201)  # μm

# Compute PSF values on the grid
intensity_values = [psf(xi, yi) for yi in y, xi in x]

# Visualize with CairoMakie
using CairoMakie
fig = Figure(size=(600, 500))
ax = Axis(fig[1, 1], aspect=DataAspect(),
          title=&quot;Airy PSF (NA=1.4, λ=532nm)&quot;,
          xlabel=&quot;x (μm)&quot;, ylabel=&quot;y (μm)&quot;)
hm = heatmap!(ax, x, y, intensity_values, colormap=:viridis)
Colorbar(fig[1, 2], hm)
fig</code></pre><h2 id="Integration-with-Camera"><a class="docs-heading-anchor" href="#Integration-with-Camera">Integration with Camera</a><a id="Integration-with-Camera-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-Camera" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Create camera with 100nm pixels (20×20 pixel grid)
pixel_size = 0.1  # μm
camera = IdealCamera(1:20, 1:20, pixel_size)

# Create emitter at position (1μm, 1μm) with 1000 photons
emitter = Emitter2D(1.0, 1.0, 1000.0)

# Integrate PSF over pixels with 2×2 subsampling
pixels = integrate_pixels(psf, camera, emitter, sampling=2)

# Visualize the camera image
using CairoMakie
fig = Figure(size=(500, 400))
ax = Axis(fig[1, 1], aspect=DataAspect(),
          title=&quot;Integrated Camera Image&quot;,
          xlabel=&quot;x (μm)&quot;, ylabel=&quot;y (μm)&quot;)
ax.yreversed = true  # Flip y-axis to match camera convention

# Get physical coordinates of pixel centers
x_centers = (1:20) * pixel_size .- pixel_size/2
y_centers = (1:20) * pixel_size .- pixel_size/2

hm = heatmap!(ax, x_centers, y_centers, pixels&#39;, colormap=:viridis)
scatter!(ax, [emitter.x], [emitter.y], color=:red, marker=:cross, markersize=15)
Colorbar(fig[1, 2], hm)
fig</code></pre><h2 id="Properties-of-the-Airy-Pattern"><a class="docs-heading-anchor" href="#Properties-of-the-Airy-Pattern">Properties of the Airy Pattern</a><a id="Properties-of-the-Airy-Pattern-1"></a><a class="docs-heading-anchor-permalink" href="#Properties-of-the-Airy-Pattern" title="Permalink"></a></h2><p>The Airy pattern has several notable features that distinguish it from the Gaussian approximation:</p><ol><li><strong>Central Maximum</strong>: Contains 83.8% of the total intensity</li><li><strong>First Minimum</strong>: Occurs at a radius of 1.22λ/NA (the Rayleigh criterion)</li><li><strong>First Ring</strong>: Contains 7.2% of the total intensity</li><li><strong>Subsequent Rings</strong>: Contain decreasing fractions of the intensity</li><li><strong>Infinite Extent</strong>: Unlike the Gaussian, which asymptotically approaches zero, the Airy pattern extends to infinity with alternating rings</li></ol><h2 id="Performance-Considerations"><a class="docs-heading-anchor" href="#Performance-Considerations">Performance Considerations</a><a id="Performance-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Considerations" title="Permalink"></a></h2><p>The Airy2D PSF offers a good balance between physical accuracy and computational efficiency:</p><ul><li>More computationally intensive than Gaussian2D due to Bessel function evaluations</li><li>Much faster than 3D models like Scalar3DPSF and Vector3DPSF</li><li>Handles the special case at r=0 efficiently by using a series expansion</li><li>Well-suited for applications where diffraction rings are important but 3D effects are not</li></ul><h2 id="Limitations"><a class="docs-heading-anchor" href="#Limitations">Limitations</a><a id="Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Limitations" title="Permalink"></a></h2><p>The Airy2D model has several limitations:</p><ol><li><strong>2D Only</strong>: Only valid for in-focus imaging (no defocus modeling)</li><li><strong>Paraxial Approximation</strong>: Less accurate for very high-NA objectives (&gt; 1.4)</li><li><strong>No Aberrations</strong>: Doesn&#39;t account for optical aberrations</li><li><strong>No Polarization</strong>: Doesn&#39;t model polarization effects</li><li><strong>No Refractive Index Mismatches</strong>: Assumes uniform media</li></ol><h2 id="Relationship-to-Other-PSFs"><a class="docs-heading-anchor" href="#Relationship-to-Other-PSFs">Relationship to Other PSFs</a><a id="Relationship-to-Other-PSFs-1"></a><a class="docs-heading-anchor-permalink" href="#Relationship-to-Other-PSFs" title="Permalink"></a></h2><p>The Airy2D pattern is related to other PSF models in the following ways:</p><ol><li><strong>Gaussian2D</strong>: The Airy pattern can be approximated by a Gaussian with σ ≈ 0.22λ/NA</li><li><strong>Scalar3DPSF</strong>: The Airy2D pattern is the in-focus (z=0) slice of the Scalar3DPSF with no aberrations</li><li><strong>Vector3DPSF</strong>: For low-NA objectives, the in-focus Vector3DPSF approaches the Airy pattern</li></ol><p>For applications requiring 3D imaging or higher physical accuracy, consider using <code>Scalar3DPSF</code> or <code>Vector3DPSF</code> models instead.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gaussian2d/">« Gaussian2D</a><a class="docs-footer-nextpage" href="../scalar3d/">Scalar3D »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 14 March 2025 20:50">Friday 14 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
